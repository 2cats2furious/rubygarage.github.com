<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
      <meta charset="utf-8" />
      <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
      <title>Views</title>
      <link href="assets/views.css" rel="stylesheet" />
      <script src="assets/views.js"></script>
   </head>
   <body class="deck-container">

<!-- Begin slides. Just make elements with a class of slide. -->
<section id="topic" class="slide"><div class="vcenter">
    <h1>View</h1>
    <div class="about">
      <p>Action View is the <strong>V </strong> in MVC. View responsible for displaying data. It doesn't make any logic operations. <strong>Only displaying data. </strong></p>
      <img class="mvc" src="/public/views/assets/mvc.png" /></div>
  </div>
</section><section id="responses" class="slide"><h2>Responses</h2>
  <p>From the controller's point of view, there are three ways to create an HTTP response:</p>
  <ul><li>Call render to create a full response to send back to the browser</li>
    <li>Call redirect_to to send an HTTP redirect status code to the browser</li>
    <li>Call head to create a response consisting solely of HTTP headers to send back to the browser</li>
  </ul></section><section id="default-rendering" class="slide"><h2>Default rendering</h2>
  config/routes.rb
  <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
      Blog::Application.routes.draw do
        resources :posts
      end
  ]]></script>
  app/controllers/posts_controller.rb
  <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
      class PostsController<ApplicationController
        def index
          @posts = Post.all
          respond_to do |format|
            format.html # app/views/posts/index.html.erb
            format.json # app/views/posts/index.json.jbuilder
          end
        end
      end
  ]]></script></section><section id="erb" class="slide"><h2>.erb</h2>
  app/views/posts/index.html.erb 
  <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
    <h1>Listing posts</h1>

    <table>
      <thead>
        <tr>
          <th>Title</th>
          <th>Text</th>
          <th></th>
          <th></th>
          <th></th>
        </tr>
      </thead>

      <tbody>
        &lt;% @posts.each do |post| %&gt;
          <tr>
            <td>&lt;%= post.title %&gt;</td>
            <td>&lt;%= post.text %&gt;</td>
            <td>&lt;%= link_to 'Show', post %&gt;</td>
            <td>&lt;%= link_to 'Edit', edit_post_path(post) %&gt;</td>
            <td>&lt;%= link_to 'Destroy', post, method: :delete, data: { confirm: 'Are you sure?' } %&gt;</td>
          </tr>
        &lt;% end %&gt;
      </tbody>
    </table>

    <br>

    &lt;%= link_to 'New Post', new_post_path %&gt;
  ]]></script></section><section id="jbuilder" class="slide"><h2>.jbuilder</h2>
  app/views/posts/index.json.jbuilder 
  <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
    json.array!(@posts) do |post|
      json.extract! post, :id, :title, :text
      json.url post_url(post, format: :json)
    end
  ]]></script>
  see <a href="https://github.com/rails/jbuilder" target="_blank">jbuilder docs</a>
</section><section id="render" class="slide"><h2>ActionController::Base#render method</h2>
  <p>In most cases, the ActionController::Base#render method does the heavy lifting of rendering your application's content for use by a browser. There are a variety of ways to customize the behavior of render. You can render the default view for a Rails template, or a specific template, or a file, or inline code, or nothing at all. You can render text, JSON, or XML. You can specify the content type or HTTP status of the rendered response as well.</p>

  <div class="slide" id="render-nothing">
    <h2>Rendering Nothing</h2>
    <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
        def index
          @posts = Post.all
          render nothing: true
        end
    ]]></script></div>

  <div class="slide" id="render-action">
    <h2>Rendering an Action's View</h2>
    <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
        def update
          @post = Post.find(params[:id])
          if @post.update(params[:post])
            redirect_to @post, notice: 'Post was successfully updated.'
          else
            render :edit
            #render 'edit'
            #render action: 'edit'
          end
        end
    ]]></script></div>
</section><section id="render-template" class="slide"><h2>Rendering an Action's Template from Another Controller</h2>
  <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
      def show
        @post = Post.find(params[:id])
        render 'posts/show'
        #render template: "posts/show"
      end
  ]]></script><div class="slide" id="render-file">
    <h2>Rendering an Arbitrary File</h2>
    <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
        def show
          @post = Post.find(params[:id])
          render '/var/www/blog/app/views/posts/show'
        end
    ]]></script></div>

  <div class="slide" id="render-inline">
    <h2>Rendering an inline code</h2>
    <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
        def index
          @posts = Post.all
          render inline: "&lt;% @posts.each do |p| %&gt;<p>&lt;%= p.title %&gt;</p>&lt;% end %&gt;"
        end
    ]]></script></div>

  <div class="slide" id="render-text">
    <h2>Rendering a string</h2>
    <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
        def index
          @posts = Post.all
          render plain: "Ok"
        end
    ]]></script></div>

  <div class="slide" id="render-text">
    <h2>Rendering a string in the current layout</h2>
    .txt.erb extension should be used for layout
    <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
        def index
          @posts = Post.all
          render plain: "Ok", layout: true
        end
    ]]></script></div>
</section><section id="render-format" class="slide"><h2>Rendering Format</h2>
  <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
      def index
        @posts = Post.all
        respond_to do |format|
          format.html {render html: "Count <strong>#{@posts.length}</strong>".html_safe}
          format.json {render json: @posts}
          format.xml {render xml: @posts}
          format.js {render js: "alert('Count #{@posts.length}');"}
        end
      end
  ]]></script><p>to_json, to_xml methods</p>

  <h2>Rendering raw data</h2>
  <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
    render body: "raw"
  ]]></script></section><section id="render-final" class="slide"><h2>Render</h2>
  <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
      def update
        @post = Post.find(params[:id])
        if @post.update(params[:post])
          redirect_to @post, notice: "Past was successfully updated"
        else
          render :edit
          render action: :edit
          render 'edit'
          render 'edit.html.erb'
          render action: 'edit'
          render action: 'edit.html.erb'
          render 'posts/edit'
          render 'posts/edit.html.erb'
          render template: 'posts/edit'
          render template: 'posts/edit.html.erb'
          render '/path/to/rails/app/views/posts/edit'
          render '/path/to/rails/app/views/posts/edit.html.erb'
          render file: '/path/to/rails/app/views/posts/edit'
          render file: '/path/to/rails/app/views/posts/edit.html.erb'
        end
      end
  ]]></script></section><section id="content-type-option" class="slide"><h2>The :content_type option</h2>
  <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
      def index
        @post = Post.all
        respond_to do |format|
          format.html
          format.xml do
            render template: 'posts/rss_list', content_type: 'application/rss'
          end
        end
      end
  ]]></script><div class="slide" id="status-option">
    <h2>The :status option</h2>
    <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
      render status: 404          # by code
      render status: :not_found   # by symbol
    ]]></script></div>

  <div class="slide" id="location-option">
    <h2>The :location option</h2>
    <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
        def index
          @post = Post.all
          respond_to do |format|
            format.html
            format.xml do
              render xml: @posts, location: posts_url
            end
          end
        end
    ]]></script></div>

  <div class="slide" id="layout-option">
    <h2>The :layout option</h2>
    <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
        def show
          @post = Post.find(params[:id])
          render template: 'pages/post', layout: 'post'
        end
    ]]></script></div>

  <div class="slide" id="formats-option">
    <h2>The :formats option</h2>
    <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
      render formats: [:json, :xml]
      #render formats: :xml
    ]]></script></div>
</section><section id="views-outside-of-actions" class="slide"><h2>Rendering outside of actions</h2>
  <p>Rails 5 only!</p>
  <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
    # render template
    ApplicationController.render 'templates/name'
    # render action
    PostController.render :index
    # render file
    ApplicationController.render file: 'path'
    # render inline
    ApplicationController.render inline: '&lt;%= posts_url %&gt;'
    # render partial
    PostsController.render :_post, locals: { post: Post.last }
    #render json
    PostsController.render json: Post.all
  ]]></script><h4>Assigning variables</h4>
  <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
    ApplicationController.render(
      assigns: { post: Post.first },
      inline: ''
    )
  ]]></script><h4>Request environment</h4>
  <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
    renderer = ApplicationController.renderer.new(
      http_host: 'best_post.host',
      https:      true
    )
    renderer.render inline: '&lt;%= posts_url %&gt;'
    # => 'https://best_post.host/posts'
  ]]></script></section><section id="redirect-to" class="slide"><h2>redirect_to</h2>

  <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
    redirect_to photos_url
  ]]></script><script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
    redirect_back(fallback_location: root_path)
  ]]></script><script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
    redirect_to photos_path, status: 301 #status can be both numeric or symbolic
  ]]></script><h2>render and redirect_to difference</h2>

  <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
    def index
      @post = Post.all
    end

    def show
      @post = Post.find_by(id: params[:id])
      if @post.nil?
        render action: "index"
      end
    end
  ]]></script><p>
     render :action doesn't run any code in the target action,
     so nothing will set up the @posts variable that the index view will probably require.
  </p>

  <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
    def index
      @post = Post.all
    end

    def show
      @post = Post.find_by(id: params[:id])
      if @post.nil?
        redirect_to action: :index
      end
    end
  ]]></script><p>fresh request for the index page will be done and @posts variable will be set up</p>

  <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
    def index
      @posts = Book.all
      end

      def show
      @post = Post.find_by(id: params[:id])
      if @post.nil?
        @posts = Post.all
        flash.now[:alert] = "Your post was not found"
        render "index"
      end
    end
  ]]></script></section><section id="layout" class="slide"><h2>Layout</h2>
  app/controllers/posts_controller.rb
  <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
      class PostsController < ApplicationController
        layout "post"

        def index
          @posts = Post.all
        end
      end
  ]]></script>
  app/controllers/posts_controller.rb
  <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
      class PostsController < ApplicationController
        layout :posts_layout

        def index
          @posts = Post.all
        end

        private

        def posts_layout
          current_user.admin? ? "admin" : "post"
        end
      end
  ]]></script></section><section id="layout-2" class="slide"><h2>Layout</h2>
  app/controllers/posts_controller.rb
  <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
      class PostsController < ApplicationController
        layout :layout_name

        private

        def layout_name
          @current_user.admin? ? 'admin' : 'application'
        end
      end
  ]]></script>
  app/controllers/posts_controller.rb
  <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
      class PostsController < ApplicationController
        layout Proc.new{ |controller| controller.request.xhr? ? 'popup' : 'application'}
      end
  ]]></script>
  app/controllers/posts_controller.rb
  <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
      class PostsController < ApplicationController
        layout "post", except: [:index, :create]
      end
  ]]></script>
  app/controllers/posts_controller.rb
  <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
      class PostsController < ApplicationController
        layout nil
      end
  ]]></script></section><section id="layout-inheritance" class="slide"><h2>Layout inheritance</h2>
  app/controllers/application_controller.rb
  <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
      class ApplicationController < ActionController::Base
        layout "application"
      end
  ]]></script>
  app/controllers/posts_controller.rb
  <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
      class PostsController < ApplicationController
        layout "post"
      end
  ]]></script>

  app/controllers/posts_controller.rb
  <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
    class ItemsController < PostsController
      layout false

      def show
        @item = Item.find(params[:id])
      end

      def index
        @items = Item.old
        render layout: "item"
      end
      # ...
    end
  ]]></script></section><section id="double-render-error" class="slide"><h2>Avoiding Double Render Errors</h2>
  app/controllers/posts_controller.rb
  <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
    def show
      @post = Post.find(params[:id])
      if @post.archived?
        render action: "archived"
      end
      render action: "updated"
    end
  ]]></script>

  app/controllers/posts_controller.rb
  <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
    def show
      @post = Post.find(params[:id])
      if @post.archived?
        render action: "archived" and return
      end
      render action: "updated"
    end
  ]]></script>

  app/controllers/posts_controller.rb
  <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
    def show
      @post = Post.find(params[:id])
      if @post.archived?
        render action: "archived"
      end
    end
  ]]></script></section><section id="head" class="slide"><h2>head</h2>

  <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
    head :bad_request
  ]]></script><script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
    HTTP/1.1 400 Bad Request
    Connection: close
    Date: Sun, 24 Jan 2010 12:15:53 GMT
    Transfer-Encoding: chunked
    Content-Type: text/html; charset=utf-8
    X-Runtime: 0.013483
    Set-Cookie: _blog_session=...snip...; path=/; HttpOnly
    Cache-Control: no-cache
  ]]></script><script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
    head :created, location: post_path(@post)
  ]]></script><script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
    HTTP/1.1 201 Created
    Connection: close
    Date: Sun, 24 Jan 2010 12:16:44 GMT
    Transfer-Encoding: chunked
    Location: /posts/1
    Content-Type: text/html; charset=utf-8
    X-Runtime: 0.083496
    Set-Cookie: _blog_session=...snip...; path=/; HttpOnly
    Cache-Control: no-cache
  ]]></script></section><section id="layouts-structuring" class="slide"><h2>Layouts structuring</h2>

  <ul><li>Asset tags</li>
    <li><b>yield</b> and <b>content_for</b></li>
    <li>Partials</li>
  </ul></section><section id="asset-tags" class="slide"><h2>Asset tags </h2>

  <ul><li>auto_discovery_link_tag</li>
    <li>javascript_include_tag</li>
    <li>stylesheet_link_tag</li>
    <li>image_tag</li>
    <li>video_tag</li>
    <li>audio_tag</li>
  </ul><h3>Linking to Feeds</h3>
  <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
    &lt;%= auto_discovery_link_tag(:rss, {action: "feed"}, {title: "RSS Feed"}) %&gt;
  ]]></script><h4>Options</h4>
  <ul><li><b>:rel</b> specifies the rel value in the link. The default value is "alternate".</li>
    <li><b>:type</b> specifies an explicit MIME type. Rails will generate an appropriate MIME type automatically.</li>
    <li><b>:title</b> specifies the title of the link. The default value is the uppercase :type value, for example, "ATOM" or "RSS".</li>
  </ul><h3>Linking to JavaScript Files</h3>

  <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
    &lt;%= javascript_include_tag "application" %&gt;
    <!-- '/assets/application.js' -->
    &lt;%= javascript_include_tag "application", "posts" %&gt;
    &lt;%= javascript_include_tag "http://example.com/application.js" %&gt;
  ]]></script><h4>Paths</h4>

  <p>/assets/javascripts/</p>
  <p>/public/javascripts/ (for older versions)</p>
  <h4>Files can be placed into <b>javascripts</b> directory inside:</h4>
  <ul><li>app/assets</li>
    <li>lib/assets</li>
    <li>vendor/assets</li>
  </ul><h3>Linking to CSS Files</h3>

  <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
    &lt;%= stylesheet_link_tag "application" %&gt;
    <!-- 'app/assets/stylesheets/application.css' -->
    &lt;%= stylesheet_link_tag "application", "posts" %&gt;
    &lt;%= stylesheet_link_tag "application", "posts/comments" %&gt;
    <!-- 'app/assets/stylesheets/posts/comments.css' -->
    &lt;%= stylesheet_link_tag "http://example.com/application.css" %&gt;
    <!-- can accept options :rel and :media -->
    &lt;%=  stylesheet_link_tag "application_tablet", media: "tablet" %&gt;
  ]]></script><p>by default <b>:rel</b> is 'stylesheet' and <b>:media</b> is 'screen'</p><p>

  </p><h4>Paths</h4>
  <p>/assets/stylesheets/</p>

  <h4>Files can be placed into <b>stylesheets</b> inside:</h4>
  <ul><li>app/assets</li>
    <li>lib/assets</li>
    <li>vendor/assets</li>
  </ul><h3>Linking to images</h3>

  <h4>Paths</h4>
  <p>public/images/</p>

  <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
    &lt;%= image_tag "header.png" %&gt;
    &lt;%= image_tag "icons/delete.gif" %&gt;
    &lt;%= image_tag "icons/delete.gif", {height: 45} %&gt;
    &lt;%= image_tag "home.gif" %&gt;
    <!-- ads alt - capitalized file name without extension -->
    &lt;%= image_tag "home.gif", alt: "Home" %&gt;
    &lt;%= image_tag "home.gif", size: "50x20" %&gt;
    &lt;%= image_tag "home.gif", alt: "Go Home", id: "HomeImage", class: "nav_bar" %&gt;
    <!-- possible options :class, :id or :name -->
    &lt;%=  stylesheet_link_tag "application_tablet", media: "tablet" %&gt;
    <!-- can accept options :rel and :media -->
  ]]></script><h3>Linking to videos</h3>

  <h4>Paths</h4>
  <p>public/videos/</p>

  <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
    &lt;%= video_tag "movie.ogg" %&gt;
    <!-- result -->
    &lt; video src="/videos/movie.ogg" /&gt;
  ]]></script><script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
    &lt;%= video_tag ["trailer.ogg", "movie.ogg"] %&gt;
    <!-- result -->
    &lt;video&gt;
      &lt;source src="/videos/trailer.ogg"&gt;
      &lt;source src="/videos/movie.ogg"&gt;
    &lt;/video&gt;
  ]]></script><h4>Options</h4>
  <ul><li><b>poster: "image_name.png"</b> provides an image to put in place of the video before it starts playing</li>
    <li><b>autoplay: true</b> starts playing the video on page load</li>
    <li><b>loop: true</b> loops the video once it gets to the end</li>
    <li><b>controls: true</b> provides browser supplied controls for the user to interact with the video</li>
    <li><b>autobuffer: true</b> the video will pre load the file for the user on page load</li>
  </ul><h3> Linking to audio files</h3>

  <h4>Paths</h4>
  <p>public/audios/</p>

  <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
    &lt;%= audio_tag "music.mp3" %&gt;
    &lt;%= audio_tag "music/first_song.mp3" %&gt;
  ]]></script><h4>Options</h4>
  <ul><li><b>autoplay: true</b> starts playing the audio on page load</li>
    <li><b>controls: true</b> provides browser supplied controls for the user to interact with the audio</li>
    <li><b>autobuffer: true</b> the audio will pre load the file for the user on page load</li>
  </ul></section><section id="yield" class="slide"><h2>Yield</h2>
  app/views/layouts/application.html.erb
  <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
      <html>
        <head>
          &lt;%= yield :head %&gt;
        </head>
        <body>
          &lt;%= yield %&gt;
        </body>
      </html>
  ]]></script></section><section id="content_for" class="slide"><h2>Content for</h2>
  <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
      &lt;% content_for :head do %&gt;
        <title>Post page</title>
      &lt;% end %&gt;
      <p>Hello, It is my first post!</p>
  ]]></script><script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
      <html>
        <head>
          <title>Post page</title>
        </head>
        <body>
          <p>Hello, It is my first post!</p>
        </body>
      </html>
  ]]></script></section><section id="partials" class="slide"><h2>Partials</h2>
  <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
      <!-- views/posts/_form.html.erb -->
      &lt;% = render 'form' %&gt;

      <!-- views/shared/_menu.html.erb -->
      &lt;% = render 'shared/menu' %&gt;

      <!-- views/posts/_post.html.erb -->
      &lt;% = render @post %&gt;

      <!-- views/posts/index.html.erb -->
      &lt;%= render "shared/search_filters", search: @q do |f| %&gt;
        &lt;p&gt;
          Post contains: &lt;%= f.text_field :post_contains %&gt;
        &lt;/p&gt;
      &lt;% end %&gt;
      &lt;%= render partial: "footer", layout: "bar" %&gt;

      <!-- shared/_search_filters.html.erb -->
      &lt;%= form_for(@q) do |f| %&gt;
        &lt;h1&gt;Search form:&lt;/h1&gt;
        &lt;fieldset&gt;
          &lt;%= yield f %&gt;
        &lt;/fieldset&gt;
        &lt;p&gt;
          &lt;%= f.submit "Search" %&gt;
        &lt;/p&gt;
      &lt;% end %&gt;
  ]]></script><div class="slide" id="partials-variables">
    <h2>Locals</h2>
    <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
       &lt;% = render partial: 'form', locals: {post: @post} %&gt;
    ]]></script><script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
       &lt;% = render 'form', post: @post %&gt;
    ]]></script><script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
      &lt;%= render @post, full: true %&gt;

      <!-- views/posts/_post.html.erb -->
      &lt;h2&gt;&lt;%= post.title %&gt;&lt;/h2&gt;

      &lt;% if local_assigns[:full] %&gt;
        &lt;%= simple_format post.text %&gt;
      &lt;% else %&gt;
        &lt;%= truncate post.text %&gt;
      &lt;% end %&gt;
    ]]></script><p>Every partial also has a local variable with the same name as the partial (minus the underscore). Object can be passed in to this local variable via the :object option</p>
    <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
      &lt;%= render partial: "post", object: @new_post %&gt;
    ]]></script><p>If you have an instance of a model to render into a partial, you can use a shorthand syntax. Assuming that you have _post.html.erb partial</p>
    <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
      &lt;%= render @customer %&gt;
    ]]></script></div>
</section><section id="collections" class="slide"><h2>Collection</h2>
  app/views/posts/index.html.erb
  <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
      <h1>Posts<h1>
      <table>
        <tr>
          <th>Name</th>
          <th>Title</th>
          <th>Content</th>
        </tr>
        &lt;%= render partial: "post", collection: @posts %&gt;
      </table>
  ]]></script>

  app/views/posts/_post.html.erb
  <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
      <tr>
        <td>&lt;%= post.name %&gt;</td>
        <td>&lt;%= post.title %&gt;</td>
        <td>&lt;%= post.content %&gt;</td>
      </tr>
  ]]></script><script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
      &lt;%= render @posts %&gt;
  ]]></script><p>Rails will try to determine partial name from variable name. _post.html.erb and _user.html.erb will be used</p>

  <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
      &lt;%= render [post1, user1, post2, user2] %&gt;
  ]]></script><script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
      &lt;%= render(@posts) || "There are no posts available." %&gt;
  ]]></script><script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
      &lt;%= render partial: "post", collection: @posts, as: :article %&gt;
  ]]></script><script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
      &lt;% =render partial: "post", collection: @posts, as: :item, locals: { title: "Post page" } %&gt;
  ]]></script><script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
      &lt;% =render partial: "post", collection: @posts, layout: "single_post_layout" %&gt;
  ]]></script><h2>Spacer template</h2>
  <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
      &lt;%= render @posts, spacer_template: 'post_spacer' %&gt;
  ]]></script></section><section id="form-tag-helper" class="slide"><h2>FormTagHelper</h2>
  <p>Provides a number of methods for creating form tags that don't rely on an Active Record object assigned to the template like FormHelper does. Instead, names and values should be provided manually.</p>
  <p>form_tag, label_tag, text_field_tag, hidden_field_tag, submit_tag</p>
  <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
      &lt;%= form_tag("/posts/search", method: 'get') do %&gt;
        &lt;%= label_tag(:q, "Search for:") %&gt;
        &lt;%= text_field_tag(:q) %&gt;
        &lt;%= hidden_field_tag(:special_id, "11") %&gt;
        &lt;%= submit_tag("Search")
      &lt;% end %&gt;
  ]]></script><script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
      <form accept-charset="UTF-8" action="/posts/search" method="get">
        <label for ="q"> Search for: </label>
        <input id ="q" name = "q" type = "text" />
        <input id ="special_id" name= "special_id" type = "hidden" value="11" />
        <input name = "commit" type ="submit" value= "Search" />
      </form>
  ]]></script>
  You can find more details <a href="http://api.rubyonrails.org/classes/ActionView/Helpers/FormTagHelper.html" target="_blank"> here</a>
</section><section id="form-helper" class="slide"><h2>FormHelper</h2>
  <h3>Form for</h3>
  <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
      &lt;%= form_for(@post) do |f| %&gt;
        &lt;% if @post.errors.any? %&gt;
          <div id="error_explanation">
            <h2>&lt;%= pluralize(@post.errors.count, "error") %&gt;
            <ul>
              &lt;% @post.errors.full_messages.each do |msg| %&gt;
                <li>&lt;%= msg %&gt;</li>
              &lt;% end %&gt;
            </ul>
          </div>
        &lt;% end %&gt;

        <div class = "field">
          &lt;%= f.label :name %&gt; <br />
          &lt;%= f.text_field :name %&gt;
        </div>

        <div class = "field">
          &lt;%= f.label :title %&gt; <br />
          &lt;%= f.text_field :title %&gt;
        </div>

        <div class = "field">
          &lt;%= f.label :content %&gt; <br />
          &lt;%= f.text_area :content %&gt;
        </div>

        <div class = "actions">
          &lt;%= f.submit %&gt;
        </div>
      &lt;% end %&gt;
  ]]></script></section><section id="nested-attibutes" class="slide"><h2>Nested attributes</h2>
  app/modals/post.rb
  <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
      class Post < ActiveRecord::Base
        has_many :comments
        accepts_nested_attributes_for :comments
      end
  ]]></script>
  app/views/posts/_form.html.erb
  <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
      &lt;%= form_for @post do |post_form| %&gt;
        <div class = "field">
          &lt;%= post_form.label :title %&gt; <br/>
          &lt;%= post_form.text_field :title %&gt; <br/>
        </div>
        <div>
          Comments
          &lt;%= post_form.fields_for :comments do |comment_form| %&gt;
            <div class = "field">
              &lt;%= comment_form.label :text %&gt; <br />
              &lt;%= comment_form.text_field :text %&gt; <br />
            </div>
          &lt;%- end %&gt;
        </div>
        <div class ="field">
          &lt;%= post_form.label :content %&gt; <br />
          &lt;%= post_form.text_area :content %&gt; <br />
        </div>
        <div class = "actions">
          &lt;%= post_form.submit %&gt;
        </div>
      &lt;%- end %&gt;
  ]]></script></section><section id="nested-attibutes-html" class="slide"><h2>Nested attributes</h2>

  <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
    <form  accept-charset ="UTF-8" action="/posts/2" class="edit_post" =" edit_post" method = "post">
      <div style ="margin:0;padding:0;display:inline">
        <input name="utf8" type="hidden" value="&#x2713;" />
        <input name="_method" type="hidden" value="put" />
        <input name="authenticity_token" type="hidden" value="IOTTvaKsTlk..." />
      </div>
      <div class="field">
        <label for="post_title"> Title</label><br />
        <input id="post_title" name="post[title]" size="30" type="text" value="Some cool title" />
      </div>
        Comments
          <div class="field">
            <label for="post_comments_attributes_0_text"> Text</label><br />
            <input id="post_comments_attributes_0_text" name="post[comments_attributes][0][text]" size="30" type="text" value="comment" />
          </div>
          <input id="post_comments_attributes_0_id" name="post[comments_attributes][0][id]" type="hidden" value ="1">
          <div class="field">
            <label for="post_comments_attributes_1_text"> Text</label><br />
            <input id="post_comments_attributes_1_text" name="post[comments_attributes][1][text]" size="30" type="text" value="comment" />
          </div>
          <input id="post_comments_attributes_1_id" name="post[comments_attributes][1][id]" type="hidden" value ="2">
          <div class="field">
            <label for="post_comments_attributes_2_text"> Text</label><br />
            <input id="post_comments_attributes_2_text" name="post[comments_attributes][2][text]" size="30" type="text" value="comment" />
          </div>
          <input id="post_comments_attributes_2_id" name="post[comments_attributes][2][id]" type="hidden" value ="3">
          <div class ="field">
            <label for="post_content">Content</label><br/>
            <textarea cols="40" id="post_content" name="post[content]" rows="20"> Some string with with sense</textarea>
          </div>
          <div class="actions">
            <input name="commit" type="submit" value="Update Post"/>
          </div>
        </form>
  ]]></script></section><section id="views-spec" class="slide"><h2>Testing views</h2>
  spec/views/posts/index_spec.rb
  <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
      describe "posts/index.html.erb" do
        it "renders _post partial for each post" do
          assign(:posts, [stub_model(Post), stub_model(Post)])
          render
          view.should render_template(partial: "_post", count: 2)
        end
      end
  ]]></script>
  app/views/posts/index.html.erb
  <div class="slide" id="result-of-testing">
    <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
        <h1>Listing posts</h1>
        <table>
          <tr>
            <th>Name</th>
            <th>Title</th>
            <th>Content</th>
          </tr>
          &lt;%= render @posts %&gt;
        </table>
    ]]></script></div>

  <div class="slide" id="spec-on-page">
    spec/views/posts/show_spec.rb
    <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
        describe "posts/show.html.erb" do
          it "displays the post's title" do
            assign(:post, stub_model(Post, title: "Cool title"))
            render
            expect(rendered).to contain("Cool title")
          end
        end
    ]]></script></div>
  <div class="slide" id="spec-on-page-result">
    app/views/posts/show.html.erb
    <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
        <h1>&lt;%= @post.title %&gt;</h1>
    ]]></script></div>
  <div class="slide" id="spec-capybara">
    <h3>Capybara</h3>
    spec/spec_helper.rb
    <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
      require 'capybara/rspec'
    ]]></script>

    spec/views/posts/show_spec.rb
    <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
      require 'spec_helper'

      describe "posts/index.html.erb" do
        it "has posts list selector" do
          assign(:posts, [stub_model(Post), stub_model(Post)])
          render
          expect(rendered).to have_selector('#posts')
        end
      end
    ]]></script>

    app/views/posts/index.html.erb
    <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
        <h1>Listing posts</h1>
        <table id="posts">
          <tr>
            <th>Name</th>
            <th>Title</th>
            <th>Content</th>
          </tr>
          &lt;%= render @posts %&gt;
        </table>
    ]]></script></div>
</section><section id="helpers" class="slide"><h2>Helpers</h2>
  app/helpers/application_helper.rb
  <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
      module ApplicationHelper
        #have title_tag in your head
        def title init_value
          @title_parts ||= []
          @title_parts.unshift init_value
          init_value
        end

        #This should be in the head
        def title_tag options ={}
          content_tag :title, get_title(options)
        end

        def get_title options ={}
          @title_parts ||= []
          @title_parts.unshift options[:prefix] unless options[:prefix].nil?
          @title_parts << options[:suffix] unless options[:suffix].nil?
          separator = options.fetch(:separator, ' - ')
          @title_parts.join(separator).html_safe
        end
      end
  ]]></script><div class="slide" id="use-helper">
    app/views/posts/show.html.erb
    <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
        &lt;% title("text") %&gt;
    ]]></script>
    app/views/layouts/application.html.erb
    <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
        &lt;%= title_tag prefix: 'pr', suffix: 'sf', separator: '-' %&gt;
    ]]></script></div>
  <div class="slide" id="helper-result">
    HTML
    <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
      <title>
        pr-text-sf
      </title>
    ]]></script></div>
</section><section id="helper-method" class="slide"><h2>helper_method</h2>
  app/controllers/application_controller.rb
  <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
      class ApplicationController < ActionController::Base
        helper_method :current_user

        def current_user
          @_current_user ||= session[:current_user_id] &&
            User.find_by_id(session[:current_user_id])
        end
      end
  ]]></script></section><section id="helpers-spec" class="slide"><h2>Testing helpers</h2>
  spec/helpers/posts_spec.rb
  <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
      require 'spec_helper'

      describe PostsHelper do
        describe "#post_title" do
          it "should return post title" do
            post = stub_model(Post, title: 'New age of IT')
            post_title(post).should == 'New age of IT'
          end
        end
      end
  ]]></script>
  app/helpers/posts_spec.rb
  <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
      module PostsHelper
        def post_title(post)
          post.title
        end
      end
  ]]></script></section><section id="haml-topic" class="slide"><h2>Haml</h2>
<p>The principles of Haml: </p>
<ul><li> Markup should be beautiful</li>
<li> Markup should be DRY</li>
<li> Markup should be indented</li>
<li> Structure should be clear</li>
</ul></section><section id="haml" class="slide"><h2>Haml</h2>
  views/posts/post.html.erb
  <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
      <tr>
        <td>&lt;%= post.name %&gt;</td>
        <td>&lt;%= post.title %&gt;</td>
        <td>&lt;%= post.content %&gt;</td>
      </tr>
  ]]></script>
  views/posts/post.html.haml
  <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
      %tr
        %td= post.name
        %td= post.title
        %td= post.content
  ]]></script>
  REMEMBER: Do not use spaces between tag and '='
  <div class="slide" id="haml-attributes">
    <h2>Attributes</h2>
    views/posts/post.html.haml
    <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
        %tr{'my-attr'=> 'some value', normal: 'other value'}
          %td= post.name
          %td= post.title
          %td= post.content
    ]]></script></div>

  <div class="slide" id="haml-boolean-attributes">
    <h2>Boolean attributes</h2>
    Haml
    <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
        %input{selected: true}
    ]]></script>
    HTML
    <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
        <input selected = "selected">
    ]]></script>
    Haml
    <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
        %input{selected: false}
    ]]></script>
    HTML
    <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
        <input>
    ]]></script></div>

  <div class="slide" id="haml-inserting-js">
    <h2>Inserting JavaScript</h2>
    <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
        %script{type: 'text/javascript'}
          console.log('script was executed');
    ]]></script></div>
</section><section id="haml-class-and-id" class="slide"><h2>Class and ID: . and #</h2>
  Haml
  <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
      %div#elems
        %span.green= "Green Label"
        %p.firstclass.secondclass
  ]]></script>
  HTML
  <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
      <div id="elems">
        <span class="green">Green Label</span>
        <p class="firstclass secondclass"></p>
      </div>
  ]]></script></section><section id="haml-vs-html" class="slide"><h2>Haml vs HTML</h2>
  Haml
  <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
    #container
      .box
        %h2 Some Headline
        %p Lorem ipsum doller your mom...
        %ul.mainList
          %li One
          %li Two
          %li Three
      .box
        %h2 Some Headline
        %p Lorem ipsum doller your mom...
        %ul.mainList
          %li One
          %li Two
          %li Three​​​
  ]]></script>
  HTML
  <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
    <div id='container'>
      <div class='box'>
        <h2>Some Headline</h2>
        <p>Lorem ipsum doller your mom...</p>
        <ul class='mainList'>
          <li>One</li>
          <li>Two</li>
          <li>Three</li>
        </ul>
      </div>
      <div class='box'>
        <h2>Some Headline</h2>
        <p>Lorem ipsum doller your mom...</p>
        <ul class='mainList'>
          <li>One</li>
          <li>Two</li>
          <li>Three​​​</li>
        </ul>
      </div>
    </div>
  ]]></script></section><!-- End slides. --><!-- deck.navigation snippet --><a href="#" class="deck-prev-link" title="Previous">←</a>
<a href="#" class="deck-next-link" title="Next">→</a>

<!-- deck.status snippet -->
<p class="deck-status">
  <span class="deck-status-current"></span>
  /
  <span class="deck-status-total"></span>
</p>

<!-- deck.hash snippet -->
<a href="." title="Permalink to this slide" class="deck-permalink">#</a>

</body>
</html>
